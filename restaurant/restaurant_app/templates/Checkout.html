{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CheckOut</title>
    <link rel="stylesheet" href="{% static 'plugins/bootstrap/css/bootstrap.css' %}">
<style>
        .table-tile {
            width: 100%; /* 设置宽度 */
            height: 500px; /* 设置高度 */
            overflow: hidden; /* 隐藏溢出内容 */
            border: 1px solid #ddd; /* 边框 */
            margin-bottom: 20px; /* 磁贴之间的间距 */
            display: flex;
            flex-direction: column;
        }

        .table-tile .panel-body {
            overflow-y: auto; /* 设置垂直滚动条 */
            flex-grow: 1; /* 让表格主体部分可伸缩 */
        }



        .panel-heading {
            background-color: #f8f9fa;
            padding: 10px;
            font-weight: bold;
            border-bottom: 1px solid #ddd;
        }

</style>
</head>
<body>

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand">Checkout</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="#">Link <span class="sr-only">(current)</span></a></li>
        <li><a href="#">Link</a></li>
          </ul>
        </div>



</div>
</nav>




<div class="container" style="width: 50%">
    <div class="row">

{% for order_id, items in checklist.items %}

            <div class="table-tile">
                <div class="panel-heading">Invoice No.{{ items.0.InvoiceID }}</div>
                <div class="panel-heading">Order No. {{ order_id }}</div>
                <div class="panel-body">
                    <table class="table">
                        <thead>
                        <tr>
                            <th  style="width: 10%;">#</th>
                            <th  style="width: 40%;">Food Name</th>
                            <th>Quantity</th>
                            <th>Price</th>
                            <th style="width: 20%;">Subtotal</th>

                        </tr>
                        </thead>
                        <tbody>

{% for item in items %}
                        <tr>
                            <th scope="row">{{forloop.counter}}</th>
                            {% if item.cancled %}
                            <td>{{ item.foodname }} [cancled]</td>
                            <td>{{ item.quantity }}</td>
                            <td>{{ item.price }}</td>
                             <td>0.00</td>
                            {% else %}

                            <td>{{ item.foodname }}</td>
                            <td>{{ item.quantity }}</td>
                            <td>{{ item.price }}</td>
                            <td>{{ item.subtotal }}</td>
                        {% endif %}

                        </tr>
 {% endfor %}


                        </tbody>
                    </table>
                </div>

                <div class="panel-footer" style="height: 60px">
                    <p class="pull-right" style="font-size:24px;font-weight: bold;padding: 10px;padding-right: 20px" id="total_price"></p>
                </div>

                    <div class="panel-footer">

                          <form method="post" action="/checkout/{{ order_id }}/" style="font-size:14px;">
                              {% csrf_token %}
                              <div style="font-size:16px;padding-left:80%">Payment Method :</div>
                            <div class="form-check form-check-inline " style="padding-left:80%">
                            <input class="form-check-input" type="radio" name="option" id="qr" value="qr">
                            <label class="form-check-label" for="qr">QR</label>
                            <input class="form-check-input" type="radio" name="option" id="crash" value="crash" checked>
                            <label class="form-check-label" for="cash">Cash</label>
                            </div>


                        <button type="submit" class="btn btn-default col-md-4 dynamic-font  pull-right">CheckOut</button>
                          </form>


                    </div>

            </div>

        {% endfor %}









    </div>
</div>






<!-- 添加更多行 -->


<script>
  let total = 0.00;
  {% for order_id, items in checklist.items %}
      {% for item in items %}
           {% if not item.cancled %}
    total += {{ item.subtotal }};
          {% endif %}
          {% endfor %}

  {% endfor %}
  document.getElementById('total_price').textContent = `Total: ${total.toFixed(2)}`;
</script>
<script src="{% static 'js/jquery-3.7.1.min.js' %}"></script>
<script src="{% static 'plugins/bootstrap/js/bootstrap.js' %}"></script>
</body>
</html>